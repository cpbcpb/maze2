if (self.CavalryLogger) { CavalryLogger.start_js(["Z0oKf"]); }

__d("WebMessengerConfirmBlockDialog",["fbt","React","SimpleXUIDialog","XUIDialogButton.react"],(function(a,b,c,d,e,f,g){"use strict";a={show:function(a){a=a&&a.length>0?g._("You have blocked {name}",[g._param("name",a)]):g._("You have blocked the sender");var c=g._("You can access messages you've blocked by going to the Filtered Messages list."),d=b("React").createElement("div",null,b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("OK"),use:"confirm"}));b("SimpleXUIDialog").showEx(c,a,d)}};e.exports=a}),null);
__d("WebMessengerDeclineMRDialog",["fbt","React","SimpleXUIDialog","MercuryThreadActions","XUIDialogButton.react","XUIDialogCancelButton.react","MercuryIDs","MessengerMessageRequestsTypedLogger","WebMessengerConfirmBlockDialog","FantaTabActions","MessagingTag","CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("MercuryThreadActions").get();a={show:function(a,c,d,e,f){__p&&__p();var i=function(d){b("WebMessengerConfirmBlockDialog").show(d);d=b("MercuryIDs").getThreadKeyfromThreadIDUserID(c,b("CurrentUser").getID());b("FantaTabActions").closeTab(c);h.changeFolder(a.thread_id,b("MessagingTag").OTHER);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_block_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c)).setSurface("thread").setFolderType(b("MessagingTag").PENDING).setThreadKey(d).setEntryPoint(null).log()},j=e?b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Ignore"),use:"confirm",onClick:function(d){a.folder===b("MessagingTag").OTHER?(h["delete"](c),b("FantaTabActions").closeTab(c)):h.ignoreMessages(b("MercuryIDs").getThreadFBIDFromThreadID(c))}}):b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Block"),use:"confirm",onClick:function(){h.blockMessages(c,i)}}),k=g._("Decline Conversation");e=e?g._("Request will be declined. Would you like to delete the messages from this group?"):g._("Message request will be declined. Would you like to block this person on Facebook or delete these messages?");var l=b("CurrentUser").getID(),m=b("MercuryIDs").getThreadKeyfromThreadIDUserID(c,l);l=function(a){a==="hide"&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c)).setSurface("thread").setFolderType(b("MessagingTag").PENDING).setThreadKey(m).setEntryPoint(null).log()};j=b("React").createElement("div",null,b("React").createElement(b("XUIDialogCancelButton.react"),null),b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:g._("Delete"),use:"confirm",onClick:function(){h["delete"](c),d&&d(),new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(c)).setSurface("thread").setFolderType(b("MessagingTag").PENDING).setThreadKey(m).setEntryPoint(null).log()}}),j);b("SimpleXUIDialog").showEx(e,k,j,l,{causalElement:f})}};e.exports=a}),null);
__d("MercuryJewelCountControl",["Arbiter","MercuryDispatcher","MercuryThreadInformer","MercuryUnseenState","UserActivity"],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";__p&&__p();var c=b("MercuryDispatcher").get(),d=b("MercuryThreadInformer").get();this.$2=b("MercuryUnseenState").get();this.render();c.subscribe("model-update-completed",function(a,b){this.$3(!1)}.bind(this));d.subscribe("unseen-updated",function(){return this.render()}.bind(this));this.$1=a;this.$1.subscribe("marked-seen",function(){this.$3(!0)}.bind(this))}a.prototype.render=function(){"use strict";var a=this.$2.getUnseenCount();b("Arbiter").inform("jewel/count-updated",{jewel:"mercurymessages",count:a},b("Arbiter").BEHAVIOR_STATE)};a.prototype.$3=function(a){"use strict";(a||this.$1.isOpen()&&b("UserActivity").isActive())&&this.$2.markAsSeen()};a.constructStores=function(){"use strict";b("MercuryUnseenState").get()};e.exports=a}),null);
__d("MercuryPresenceIndicator.react",["cx","fbt","Arbiter","AvailableListConstants","MercuryIDs","PresenceStatus","React","SubscriptionsHandler"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(){if(!b("MercuryIDs").isCanonical(this.props.threadID))return null;else{var a=b("MercuryIDs").getUserIDFromThreadID(this.props.threadID);return b("PresenceStatus").get(a)}}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=new(b("SubscriptionsHandler"))(),this.$1.addSubscriptions(b("Arbiter").subscribe(b("AvailableListConstants").ON_AVAILABILITY_CHANGED,function(){return this.forceUpdate()}.bind(this)))};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.release()};a.prototype.render=function(){var a=this.$2();return b("React").createElement("span",{className:this.$3(a)},b("React").createElement("span",{className:"accessible_elem"},this.$4(a)))};a.prototype.$3=function(a){return"presenceIndicator"+(b("MercuryIDs").isGroupChat(this.props.threadID)?" groupThread":"")+(a==b("AvailableListConstants").ACTIVE?" presenceActive":"")};a.prototype.$4=function(a){switch(a){case b("AvailableListConstants").ACTIVE:return h._("Active");default:return null}};a.propTypes={threadID:c.string.isRequired};e.exports=a}),null);
__d("MercuryThreadPermalink.react",["Link.react","React","WebMessengerThreadPermalinks"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={permalinkURI:"#"},b}a.prototype.componentDidMount=function(){this.$1(this.props)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){(a.threadID!==this.props.threadID||a.folder!==this.props.folder)&&this.$1(a)};a.prototype.render=function(){return b("React").createElement(b("Link.react"),{className:this.props.className,href:this.state.permalinkURI,onClick:this.props.onClick,role:"button"},this.props.children)};a.prototype.$1=function(a){this.setState({permalinkURI:"#"}),b("WebMessengerThreadPermalinks").getThreadURI(a.threadID,function(a){return this.setState({permalinkURI:a})}.bind(this),a.folder)};a.propTypes={className:c.string,children:c.any,threadID:c.string.isRequired,viewer:c.string.isRequired,folder:c.string,onClick:c.func};e.exports=a}),null);
__d("MercuryThreadReadToggle.react",["fbt","invariant","MercuryThreadActions","React","ReadToggle.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){a&&(a.preventDefault(),a.stopPropagation());a=b("MercuryThreadActions").getForFBID(this.props.viewer);this.props.unreadCount>0?a.markRead(this.props.threadID):a.markUnread(this.props.threadID)}.bind(this),c}a.prototype.render=function(){this.props.unreadCount>=0||h(0);return b("React").createElement(b("ReadToggle.react"),{isRead:this.props.unreadCount===0,onClick:this.$1,readLabel:g._("Mark as Unread"),unreadLabel:g._("Mark as Read")})};a.propTypes={threadID:c.string.isRequired,viewer:c.string.isRequired,unreadCount:c.number.isRequired};e.exports=a}),null);
__d("MessagesJewelGameButtonContainer.react",["BootloadOnRender.react","ImmutableObject","JSResource","LazyComponent.react","React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return this.props.thread.game_id?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MessagesJewelGameButton.react").__setRef("MessagesJewelGameButtonContainer.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{thread:this.props.thread})}):null};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MessagesJewelInlineThumbnail.react",["cx","MercuryAttachmentType","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){var a=this.$1();if(a.length===0)return b("React").createElement("span",null);var c=a[0].thumbnail_url;if(!c)return b("React").createElement("span",null);c=b("React").createElement("span",{className:"_56hv"},b("React").createElement("i",{style:{backgroundImage:"url("+c+")"}}));a.length>1&&(c=b("React").createElement("span",null,b("React").createElement("span",{className:"_56hy"}),c));return c};a.prototype.$1=function(){var a=this.props.thread;return!a.snippet_attachments?[]:a.snippet_attachments.filter(function(a){return a.attach_type===b("MercuryAttachmentType").PHOTO})};function a(){h.apply(this,arguments)}a.propTypes={thread:c.object.isRequired};e.exports=a}),null);
__d("MessagesJewelThreadListRow.react",["cx","fbt","Promise","Bootloader","CurrentUser","ErrorBoundary.react","FBRTCCore","FBRTCLogger","ImageBlock.react","immutable","ImmutableObject","MercuryIDs","MercuryPresenceIndicator.react","MercurySeenIndicator.react","MercuryThreadActions","MercuryThreadPermalink.react","MercuryThreadReadToggle.react","MercuryThreadSnippet.react","MercuryThreadTimestampReact.bs","MercuryThreadTitle.react","MercuryTimestamp","MessagesJewelGameButtonContainer.react","MessagesJewelInlineThumbnail.react","MessagingTag","MessengerThreadImageReact.bs","MNAdsMessageUtils","React","RTCCallState","UserAgent","WebMessengerDeclineMRDialog","XUIButton.react","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FBRTCLogger").Trigger,k=b("MercuryThreadTimestampReact.bs").jsComponent,l=b("MessengerThreadImageReact.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$12=function(){b("MercuryThreadActions").get()["delete"](this.props.thread.thread_id)}.bind(this),this.$13=function(){b("MercuryThreadActions").get().archive(this.props.thread.thread_id)}.bind(this),this.$15=function(a){__p&&__p();a.preventDefault();a.stopPropagation();a=window.callWindow&&!window.callWindow.closed&&window.callWindow.focus;if(a)window.callWindow.focus();else{a=this.props.thread;var c=a.rtc_call_data;a=a.thread_fbid;b("FBRTCCore").startGroupCall({conferenceName:"GROUP:"+a,hasVideo:c.call_state===b("RTCCallState").VIDEO_GROUP_CALL,serverInfoData:c.server_info_data,trigger:j.MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON})}}.bind(this),c}a.prototype.render=function(){var a=b("UserAgent").isBrowser("Chrome")&&!b("UserAgent").isPlatform("Windows")?b("React").createElement("div",{className:"author fixemoji"},this.$2(),this.$3()):b("React").createElement("div",{className:"author"},b("React").createElement("strong",null,this.$2()),this.$3());a=b("React").createElement(b("ImageBlock.react"),{spacing:"none"},b("React").createElement("div",{className:"_p32"},this.$4()),b("React").createElement("div",{className:"content"},a,b("React").createElement("div",{className:"_1iji"},b("React").createElement("div",{className:"_1ijj"},this.$5(),this.$6()),b("React").createElement("div",null,this.$7())),b("React").createElement("div",{className:"time"},b("MNAdsMessageUtils").isAdsMessageRequest(this.props.thread)?b("MNAdsMessageUtils").renderAdsMessageRequestStatus():this.$8()),this.$9()),b("React").createElement("div",null,b("React").createElement(b("MessagesJewelInlineThumbnail.react"),{thread:this.props.thread}),b("React").createElement("div",{className:"x_div"},this.$10())));return b("React").createElement("li",{className:this.props.thread.unread_count>0?"jewelItemNew":""},b("React").createElement(b("MercuryThreadPermalink.react"),{className:"messagesContent",threadID:this.props.thread.thread_id,viewer:this.props.viewer,folder:this.props.thread.folder,onClick:this.props.onClick},a))};a.prototype.$7=function(){__p&&__p();if(this.props.thread.folder!==b("MessagingTag").PENDING)return null;var a=b("CurrentUser").getID(),c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.thread.thread_id,a);return b("React").createElement("div",{className:"_zjy"},b("React").createElement(b("XUIButton.react"),{use:"confirm",onClick:function(a){a.preventDefault(),b("MercuryThreadActions").get().changeFolder(this.props.thread.thread_id,b("MessagingTag").INBOX),b("promiseDone")(this.$11(),function(a){a.setAction("message_requests_accept_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.thread.thread_id)).setThreadKey(c).log()}.bind(this))}.bind(this),label:h._("Accept")}),b("React").createElement(b("XUIButton.react"),{onClick:function(a){a.preventDefault();var d=b("MercuryIDs").isGroupChat(this.props.thread.thread_id);b("WebMessengerDeclineMRDialog").show(this.props.thread,this.props.thread.thread_id,this.$12,d);a.stopPropagation();b("promiseDone")(this.$11(),function(a){a.setAction("message_requests_decline_attempt").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.thread.thread_id)).setThreadKey(c).log()}.bind(this))}.bind(this),use:"default",label:h._("Decline")}))};a.prototype.$3=function(){return!this.props.showPresence?null:b("React").createElement(b("MercuryPresenceIndicator.react"),{threadID:this.props.thread.thread_id})};a.prototype.$4=function(a){return b("React").createElement(l,{size:48,thread:this.props.thread,useBackground:!0,viewer:this.props.viewer,participants:this.props.participants})};a.prototype.$2=function(){return b("React").createElement(b("MercuryThreadTitle.react"),{thread:this.props.thread,viewer:this.props.viewer,showUnreadCount:!0})};a.prototype.$6=function(){return b("React").createElement(b("MercuryThreadSnippet.react"),{participants:this.props.participants,thread:this.props.thread,viewer:this.props.viewer})};a.prototype.$8=function(){return b("React").createElement(k,{time:this.props.thread.timestamp,title:b("MercuryTimestamp").getAbsoluteTimestamp(this.props.thread.timestamp),text:b("MercuryTimestamp").getRelativeTimestamp(this.props.thread.timestamp)})};a.prototype.$5=function(){return b("React").createElement(b("MercurySeenIndicator.react"),{thread:this.props.thread,viewer:this.props.viewer,readReceipts:this.props.readReceipts})};a.prototype.$10=function(){return b("React").createElement(b("MercuryThreadReadToggle.react"),{threadID:this.props.thread.thread_id,viewer:this.props.viewer,unreadCount:this.props.thread.unread_count})};a.prototype.$9=function(){var a=this.$14();return!a&&this.props.thread.folder!==b("MessagingTag").PENDING?b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("MessagesJewelGameButtonContainer.react"),{thread:this.props.thread})):a};a.prototype.$14=function(){if(!this.props.thread.rtc_call_data||this.props.thread.rtc_call_data.call_state===b("RTCCallState").NO_ONGOING_CALL)return null;var a=window.callWindow&&!window.callWindow.closed?h._("Return to Call"):h._("Join Call");return b("React").createElement(b("XUIButton.react"),{className:"_4oci",label:a,onClick:this.$15})};a.prototype.$11=function(){this.$1||(this.$1=new(b("Promise"))(function(a,c){b("Bootloader").loadModules(["MessengerMessageRequestsTypedLogger"],function(b){b=new b();b.setSurface("inbox").setFolderType("pending").setEntryPoint("inbox_banner");a(b)},"MessagesJewelThreadListRow.react")}));return this.$1};a.propTypes={onClick:c.func,participants:c.instanceOf(b("immutable").Map).isRequired,showPresence:c.bool,thread:c.instanceOf(b("ImmutableObject")).isRequired,viewer:c.string.isRequired};e.exports=a}),null);
__d("MessagesJewelThreadlistRowContainer.react",["ChatOpenTab","ChatOpenTabEventLogger","CurrentUser","FantaTabActions","ImmutableObject","MercuryIDs","MercuryThreadlistRowContainer.react","MessagesJewelThreadListRow.react","MessagingTag","MessengerDiscoveryEntryPoint","MessengerMessageRequestsTypedLogger","React","ReactComponentWithPureRenderMixin","TimeSlice"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"MessagesJewelThreadlistRowContainer",mixins:[b("ReactComponentWithPureRenderMixin")],propTypes:{folder:a.string,readReceipts:a.object,thread:a.instanceOf(b("ImmutableObject")).isRequired,viewer:a.string.isRequired,handleChatTabOpen:a.func},render:function(){return b("React").createElement(b("MercuryThreadlistRowContainer.react"),{ChildClass:b("MessagesJewelThreadListRow.react"),onClick:this._handleClick,showPresence:b("ChatOpenTab").canOpenTab(),readReceipts:this.props.readReceipts,thread:this.props.thread,viewer:this.props.viewer})},_handleClick:function(a){__p&&__p();if(a.button===1||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)return;if(!b("ChatOpenTab").canOpenTab())return;this.props.handleChatTabOpen&&b("TimeSlice").guard(this.props.handleChatTabOpen,"Jewelupdate after Chat tab open",{propagationType:b("TimeSlice").PropagationType.ORPHAN})();a.preventDefault();a=this.props.thread.thread_id;var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(a,c);b("FantaTabActions").openTab(a,[b("MessengerDiscoveryEntryPoint").FB_HEADER_DOCK_JEWEL_THREAD]);b("ChatOpenTabEventLogger").logClickOpen("jewel",a);var d;switch(this.props.folder){case"inbox":d="inbox";break;case"pending":d="pending";break;case"other":d="other";break}this.props.thread.folder!==b("MessagingTag").INBOX&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_thread_open").setThreadID(b("MercuryIDs").getUserIDFromThreadID(a)).setSurface(d).setFolderType(this.props.thread.folder).setThreadKey(c).log()}});e.exports=c}),null);
__d("MessagesJewelThreadList.react",["cx","fbt","Arbiter","BootloadedComponent.react","ChatConfig","CurrentUser","EventProfiler","ImmutableObject","JSResource","Link.react","MercuryConfig","MessengerState.bs","MessagesJewelThreadlistRowContainer.react","MessagingTag","React","ScrollableArea.react","SubscriptionsHandler","TimeSlice","XUISpinner.react","debounce","getViewportDimensions","requireWeak","requestIdleCallback","throttle"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=160,k=60,l=10;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=new(b("SubscriptionsHandler"))(),this.$4=function(){if(this.props.isLoaded||!this.refs.scrollable)return;var a=this.refs.scrollable.getArea();if(!a)return;a.getScrollTop()+a.getClientHeight()>=a.getScrollHeight()-1&&(this.props.onLoadMoreRequest&&this.props.onLoadMoreRequest())}.bind(this),this.$10=function(a){a.preventDefault(),this.props.onLoadMoreRequest&&this.props.onLoadMoreRequest()}.bind(this),this.$9=function(a){this.props.onFilteredRequestsClick&&this.props.onFilteredRequestsClick(a)}.bind(this),this.state={height:this.$3(),hasQP:!1},c}a.prototype.componentDidMount=function(){__p&&__p();this.$2=Event.listen(window,"resize",b("debounce")(function(){this.setState({height:this.$3()})}.bind(this)));b("EventProfiler").informManualInteractionTimestamp(["Messages_Jewel_Button"],!0,"click");var a=b("ChatConfig").get("message_jewel_promotion_data");a&&this.setState({hasQP:!0},function(){this.setState({height:this.$3()})}.bind(this));this.$1.addSubscriptions(b("Arbiter").subscribeOnce("hideMessageJewelQP",function(){this.setState({hasQP:!1},function(){this.setState({height:this.$3()})}.bind(this))}.bind(this)));a=function(){b("requestIdleCallback")(function(){b("requireWeak")("FantaTabsEagerBootloader",function(a){return a.bootload()})})};b("TimeSlice").guard(a,"JewelOpen fanta eagerbootloader",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.componentDidUpdate=function(a){a.threads.length===0&&this.props.threads.length!==0&&(this.props.onRenderThreads&&this.props.onRenderThreads()),b("EventProfiler").informManualInteractionTimestamp(["Messages_Jewel_Button"],!0,"click")};a.prototype.componentWillUnmount=function(){this.$2.remove(),this.$1.release()};a.prototype.render=function(){return b("React").createElement(b("MessengerState.bs").jsComponent,{fbid:b("CurrentUser").getID()},function(a){return b("React").createElement(b("ScrollableArea.react"),{className:"_2q3u",height:this.state.height,onScroll:b("throttle")(this.$4,50),ref:"scrollable"},b("React").createElement("ul",{className:"jewelContent"},this.props.p2pJewelBannerContainer?b("React").createElement("li",null,this.props.p2pJewelBannerContainer):null,this.$5(),this.props.threads.map(function(c){return this.$6(c,b("MessengerState.bs").pendingFolderUnseenCount(a),b("MessengerState.bs").readReceiptsPerThread(a))}.bind(this))),this.$7())}.bind(this))};a.prototype.$6=function(a,c,d){if(Array.isArray(a))return this.$8(a,c);else return b("React").createElement(b("MessagesJewelThreadlistRowContainer.react"),{folder:this.props.folder,key:a.thread_id,showAggregation:this.props.showAggregation,thread:a,viewer:this.props.viewer,handleChatTabOpen:this.props.handleChatTabOpen,readReceipts:d})};a.prototype.$3=function(){var a=(this.props.maxInitialThreadCount||l)*k-(this.state&&this.state.hasQP?260:0);return Math.min(a,b("getViewportDimensions")().height-j)};a.prototype.$7=function(){if(this.props.showAggregation)return null;else if(this.props.isLoaded)return this.props.folder===b("MessagingTag").PENDING?b("React").createElement("div",{className:"_16bh _16bi"},b("React").createElement(b("Link.react"),{onClick:this.$9},h._("See filtered messages"))):null;return this.props.isLoading?b("React").createElement(b("XUISpinner.react"),{className:"jewelLoading"}):b("React").createElement("div",{className:"_v8y"},b("React").createElement(b("Link.react"),{href:"#",onClick:this.$10},h._("Show Older")))};a.prototype.$8=function(a,c){var d=b("MercuryConfig").MCMA,e=this.props.newMessageRequestThreads;a&&d&&(e=a);return!this.props.jewelRequestsUI&&!d||this.props.folder===b("MessagingTag").PENDING||!e||e.length===0?null:b("React").createElement(b("BootloadedComponent.react"),{key:e[0].thread_id,bootloadPlaceholder:b("React").createElement("li",{style:{height:60}}),bootloadLoader:b("JSResource")("MessagesJewelMessageRequestsRow.react").__setRef("MessagesJewelThreadList.react"),onClick:function(a){return this.$11(a,e)}.bind(this),pendingFolderUnseenCount:c,threads:e,viewer:this.props.viewer})};a.prototype.$5=function(){return!this.props.jewelRequestsUI||this.props.folder!==b("MessagingTag").PENDING?null:b("React").createElement("li",{className:"_16bh _16bi"},h._("Open a request to get more info about who's messaging you."),b("React").createElement("br",null),h._("They won't know you've seen it until you accept."))};a.prototype.$11=function(a,b){this.props.onAggregationClick&&this.props.onAggregationClick(a,b)};a.propTypes={folder:c.string,isLoaded:c.bool,isLoading:c.bool,maxInitialThreadCount:c.number,jewelRequestsUI:c.bool,onFilteredRequestsClick:c.func,onLoadMoreRequest:c.func,onMessageRequestsClick:c.func,onRenderThreads:c.func,onAggregationClick:c.func,p2pJewelBannerContainer:c.element,showAggregation:c.bool,threads:c.arrayOf(c.oneOfType([c.instanceOf(b("ImmutableObject")),c.arrayOf(c.instanceOf(b("ImmutableObject")))])).isRequired,viewer:c.string.isRequired};e.exports=a}),null);
__d("XMessagingMarkPendingFolderAsSeenController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/mercury/mark_pending_folder_as_seen/",{})}),null);
__d("MercuryJewelThreadlistControl",["csx","cx","fbt","ArbiterMixin","AsyncRequest","CSS","CurrentUser","DOM","Event","JSLogger","MercuryFilters","MercuryThreadActions","MercuryThreadInformer","MercuryThreadlistConstants","MercuryThreadlistContainer.react","MercuryUnreadState","MessagesJewelThreadList.react","MessagingTag","MessengerURIConstants","React","ReactDOM","XMessagingMarkPendingFolderAsSeenController","gkx","mixin"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j,k=b("JSLogger").create("mercury_jewel"),l=b("MessagingTag").PENDING,m="back_to_inbox",n=i._("See All in Messenger");c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));j=c&&c.prototype;function a(a){"use strict";__p&&__p();j.constructor.call(this);this.$JewelThreadlistControl17=function(a,c){a.preventDefault();new(b("AsyncRequest"))().setURI(b("XMessagingMarkPendingFolderAsSeenController").getURIBuilder().getURI()).send();this.$JewelThreadlistControl1=c;a=this.$JewelThreadlistControl3;this.$JewelThreadlistControl6[a]&&b("CSS").removeClass(this.$JewelThreadlistControl6[a],"_1sdd");this.$JewelThreadlistControl8=!1;this.$JewelThreadlistControl3=b("MessagingTag").MESSAGE_REQUEST_AGGREGATION_UNIT;this.render()}.bind(this);this.$JewelThreadlistControl15=function(a){a.preventDefault(),this.$JewelThreadlistControl9(b("MessagingTag").PENDING,b("MercuryFilters").ALL)}.bind(this);this.$JewelThreadlistControl16=function(a){a.preventDefault(),this.$JewelThreadlistControl9(b("MessagingTag").OTHER,b("MercuryFilters").ALL)}.bind(this);a=a.getFlyout();this.$JewelThreadlistControl1=[];this.$JewelThreadlistControl2=b("DOM").find(a,"._3v_l");this.$JewelThreadlistControl3=b("MessagingTag").INBOX;this.$JewelThreadlistControl4=b("MercuryFilters").ALL;this.$JewelThreadlistControl5=b("CurrentUser").getID();this.$JewelThreadlistControl6={};this.$JewelThreadlistControl7={};this.$JewelThreadlistControl6[b("MessagingTag").INBOX]=b("DOM").find(a,"._1sde");this.$JewelThreadlistControl7[b("MessagingTag").INBOX]=b("DOM").find(a,"._1sdg");this.$JewelThreadlistControl8=!1;b("Event").listen(this.$JewelThreadlistControl6[b("MessagingTag").INBOX],"click",function(){return this.$JewelThreadlistControl9(b("MessagingTag").INBOX,b("MercuryFilters").ALL)}.bind(this));!b("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h")?(this.$JewelThreadlistControl6[l]=b("DOM").find(a,"._1sdf"),this.$JewelThreadlistControl7[l]=b("DOM").find(a,"._1sdh"),b("Event").listen(this.$JewelThreadlistControl6[l],"click",function(){return this.$JewelThreadlistControl9(l,b("MercuryFilters").ALL)}.bind(this))):(this.$JewelThreadlistControl6[m]=b("DOM").find(a,"._34zq"),b("Event").listen(this.$JewelThreadlistControl6[m],"click",function(){return this.$JewelThreadlistControl9(b("MessagingTag").INBOX,b("MercuryFilters").ALL)}.bind(this)));this.$JewelThreadlistControl10=b("DOM").find(a,"._1c1m");this.$JewelThreadlistControl11=b("DOM").find(a,"._4djt");this.$JewelThreadlistControl12=b("MercuryUnreadState").get();b("Event").listen(this.$JewelThreadlistControl10,"click",function(a){this.$JewelThreadlistControl13(),a.kill()}.bind(this));b("MercuryThreadInformer").get().subscribe("unread-updated",function(){return this.$JewelThreadlistControl14()}.bind(this));this.$JewelThreadlistControl14();this.render();k.bump("opened_threadlist_"+this.$JewelThreadlistControl3)}a.prototype.render=function(){"use strict";b("ReactDOM").render(b("React").createElement(b("MercuryThreadlistContainer.react"),{ChildClass:b("MessagesJewelThreadList.react"),folder:this.$JewelThreadlistControl3,filter:this.$JewelThreadlistControl4,jewelRequestsUI:b("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h"),viewer:this.$JewelThreadlistControl5,onMessageRequestsClick:this.$JewelThreadlistControl15,onFilteredRequestsClick:this.$JewelThreadlistControl16,onAggregationClick:this.$JewelThreadlistControl17,resetAggregatedThreads:this.$JewelThreadlistControl8,threadIDs:this.$JewelThreadlistControl1}),this.$JewelThreadlistControl2)};a.prototype.$JewelThreadlistControl13=function(){"use strict";this.$JewelThreadlistControl3===b("MessagingTag").MESSAGE_REQUEST_AGGREGATION_UNIT?b("MercuryThreadActions").get().batchMarkRead(this.$JewelThreadlistControl1,b("MessagingTag").MESSAGE_REQUEST_AGGREGATION_UNIT):this.$JewelThreadlistControl12.markFolderAsRead(this.$JewelThreadlistControl3)};a.prototype.$JewelThreadlistControl9=function(a,c){"use strict";__p&&__p();this.$JewelThreadlistControl8=!0;this.$JewelThreadlistControl1=[];if(this.$JewelThreadlistControl3!==a||this.$JewelThreadlistControl4!==c){var d=this.$JewelThreadlistControl3,e=a===b("MessagingTag").INBOX,f=a;k.bump("opened_threadlist_"+a);this.$JewelThreadlistControl6[f]&&b("CSS").addClass(this.$JewelThreadlistControl6[f],"_1sdd");this.$JewelThreadlistControl6[d]&&b("CSS").removeClass(this.$JewelThreadlistControl6[d],"_1sdd");this.$JewelThreadlistControl3=a;this.$JewelThreadlistControl4=c;e?(this.$JewelThreadlistControl11.href=b("MessengerURIConstants").FACEBOOK_PREFIX,this.$JewelThreadlistControl11.text=n,this.$JewelThreadlistControl5=b("CurrentUser").getID()):a==l&&(this.$JewelThreadlistControl11.href=b("MessengerURIConstants").FACEBOOK_PREFIX+b("MessengerURIConstants").MESSAGE_REQUESTS_PATH,this.$JewelThreadlistControl11.text=n,this.$JewelThreadlistControl5=b("CurrentUser").getID());b("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h")&&(b("CSS").conditionShow(this.$JewelThreadlistControl6[b("MessagingTag").INBOX],e),b("CSS").conditionShow(this.$JewelThreadlistControl6[m],!e));this.render()}};a.prototype.$JewelThreadlistControl14=function(){"use strict";this.$JewelThreadlistControl18(b("MessagingTag").INBOX),b("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h")||this.$JewelThreadlistControl18(l)};a.prototype.$JewelThreadlistControl18=function(a){"use strict";var c;this.$JewelThreadlistControl12.exceedsMaxCount(a)?c=b("MercuryThreadlistConstants").MAX_UNREAD_COUNT:c=this.$JewelThreadlistControl12.getUnreadCount(a);this.$JewelThreadlistControl19(c,a)};a.prototype.$JewelThreadlistControl19=function(a,c){"use strict";c=this.$JewelThreadlistControl7[c];if(!c)return;var d=a?a.toString():0;a>0?(a==b("MercuryThreadlistConstants").MAX_UNREAD_COUNT&&(d+="+"),b("DOM").setContent(c,i._("({unread_count})",[i._param("unread_count",d)]))):b("DOM").setContent(c,"")};e.exports=a}),null);
__d("MercuryJewel",["Arbiter","EventProfiler","MercuryJewelCountControl","MercuryServerPayloadPreprocessor"],(function(a,b,c,d,e,f){__p&&__p();var g=!1,h=!1,i=null;function a(a,c){"use strict";b("MercuryJewelCountControl").constructStores(),b("MercuryServerPayloadPreprocessor").get().handleUpdate(c),this.$1=new(b("MercuryJewelCountControl"))(a),a.subscribeOnce("opened",function(){this.$2(a)}.bind(this)),a.subscribeOnce("user-open",function(){this.$3(a)}.bind(this)),a.subscribe("updated",function(b,c){c&&c.count>0&&this.$2(a)}.bind(this))}a.prototype.$2=function(a){"use strict";this.$3(a),g||(g=!0,a.isOpen()||(i=b("EventProfiler").notifyRunningEagerInteraction(["Messages_Jewel_Button"],"click")),d(["MercuryJewelThreadlistControl"],function(b){this.$4=new b(a)}.bind(this)),b("Arbiter").inform("mercury-jewel/opened",null,b("Arbiter").BEHAVIOR_STATE))};a.prototype.$3=function(a){"use strict";!h&&a.isOpen()&&(h=!0,b("EventProfiler").tagCurrentActiveInteractionsAs("FirstMercuryJewelOpen"),i&&i())};e.exports=a}),null);